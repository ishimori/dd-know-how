# CLI ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³è¨­å®šã‚¬ã‚¤ãƒ‰

Claude Code CLI ã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½¿ç”¨ç‡ã‚’å¸¸æ™‚ç›£è¦–ã™ã‚‹ãŸã‚ã®è¨­å®šæ–¹æ³•ã§ã™ã€‚

> **æ³¨æ„**: ã“ã®æ©Ÿèƒ½ã¯ **CLIå°‚ç”¨** ã§ã™ã€‚VSCodeæ‹¡å¼µã§ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

## æ¦‚è¦

ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½¿ç”¨ç‡ã‚’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã«å¸¸æ™‚è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ï¼š
- ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆè²»é‡ã‚’æŠŠæ¡
- ä½¿ç”¨ç‡ã«å¿œã˜ãŸè‰²åˆ†ã‘ã§ç›´æ„Ÿçš„ã«çŠ¶æ³ã‚’èªè­˜
- æ€¥å¢—æ™‚ã«è­¦å‘Šè¡¨ç¤º

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. statusline.js ã‚’ä½œæˆ

`~/.claude/statusline.js` ã‚’ä½œæˆã—ã¾ã™ï¼š

```javascript
// ~/.claude/statusline.js
// ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½¿ç”¨ç‡è¡¨ç¤ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ

let lastUsage = 0;
let lastTime = Date.now();

function getStatusLine(context) {
  const usage = context.tokenUsage?.percentUsed || 0;
  const currentTime = Date.now();

  // æ€¥å¢—æ¤œçŸ¥ï¼ˆ5ç§’ä»¥å†…ã«5%ä»¥ä¸Šå¢—åŠ ï¼‰
  const timeDiff = (currentTime - lastTime) / 1000;
  const usageDiff = usage - lastUsage;
  const isSpike = timeDiff < 5 && usageDiff > 5;

  lastUsage = usage;
  lastTime = currentTime;

  // è‰²åˆ†ã‘
  let color;
  let status;
  if (usage <= 50) {
    color = 'green';
    status = '';
  } else if (usage <= 70) {
    color = 'yellow';
    status = ' [æ³¨æ„]';
  } else if (usage <= 85) {
    color = 'orange';
    status = ' [è­¦å‘Š]';
  } else {
    color = 'red';
    status = ' [å±é™º]';
  }

  // æ€¥å¢—è­¦å‘Š
  const spikeWarning = isSpike ? ' âš¡æ€¥å¢—!' : '';

  return {
    text: `ğŸ“Š ${usage.toFixed(1)}%${status}${spikeWarning}`,
    color: color
  };
}

module.exports = { getStatusLine };
```

### 2. settings.json ã«è¨­å®šã‚’è¿½åŠ 

`~/.claude/settings.json` ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```json
{
  "statusLine": {
    "enabled": true,
    "script": "~/.claude/statusline.js",
    "refreshInterval": 2000
  }
}
```

### 3. Claude Code ã‚’å†èµ·å‹•

è¨­å®šã‚’åæ˜ ã™ã‚‹ãŸã‚ã€Claude Code CLI ã‚’å†èµ·å‹•ã—ã¾ã™ã€‚

## è¡¨ç¤ºå†…å®¹

### é€šå¸¸è¡¨ç¤º

```
ğŸ“Š 45.2%           â† ä½¿ç”¨ç‡50%ä»¥ä¸‹ï¼ˆç·‘ï¼‰
ğŸ“Š 62.8% [æ³¨æ„]    â† ä½¿ç”¨ç‡51-70%ï¼ˆé»„ï¼‰
ğŸ“Š 78.5% [è­¦å‘Š]    â† ä½¿ç”¨ç‡71-85%ï¼ˆæ©™ï¼‰
ğŸ“Š 92.1% [å±é™º]    â† ä½¿ç”¨ç‡86%ä»¥ä¸Šï¼ˆèµ¤ï¼‰
```

### æ€¥å¢—æ¤œçŸ¥

5ç§’ä»¥å†…ã«5%ä»¥ä¸Šä½¿ç”¨ç‡ãŒå¢—åŠ ã—ãŸå ´åˆï¼š

```
ğŸ“Š 67.3% [æ³¨æ„] âš¡æ€¥å¢—!
```

## ä½¿ç”¨ç‡ã®ç›®å®‰

| ä½¿ç”¨ç‡ | çŠ¶æ…‹ | æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|--------|------|---------------|
| 0-50% | è‰¯å¥½ | ãã®ã¾ã¾ä½œæ¥­ç¶™ç¶š |
| 51-70% | æ³¨æ„ | å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¯è¨ˆç”»çš„ã« |
| 71-85% | è­¦å‘Š | ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œ `/clear` ã‚’æ¤œè¨ |
| 86-100% | å±é™º | æ—©ã‚ã« `/clear` ã§æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ |

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

1. `~/.claude/settings.json` ã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. `statusline.js` ã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèª
3. Claude Code ã‚’å®Œå…¨ã«å†èµ·å‹•

### è‰²ãŒè¡¨ç¤ºã•ã‚Œãªã„

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒ ANSI ã‚«ãƒ©ãƒ¼ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## é–¢é€£æƒ…å ±

- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹: [context-management.md](./context-management.md)
