# DD-Know-How アップグレード通知

## v3: GEM分析（独立批判レビュー）追加（2026-02-21）

### 概要

DDの最終Phase完了時に、独立した視点からDD全体を批判的にレビューする「GEM分析」機能を追加しました。

DA批判レビューは同一会話コンテキスト内で実行されるため、楽観バイアス・盲点の共有・コンテキスト汚染という構造的限界がありました。GEM分析はこれを補完します。

### 主な変更点

#### 1. GEM分析の追加

| モード | 条件 | 効果 |
|--------|------|------|
| Gemini API | `.env` に `GEMINI_API_KEY` 設定 | 異なるモデルによる独立レビュー |
| 別コンテキストDA | API キー未設定 | コンテキスト汚染排除した別スレッドDA分析 |

#### 2. DDテンプレートに「GEM分析結果」セクション追加

既存のDA批判レビュー記録の後に、GEM分析結果を記録するセクションが追加されました。

#### 3. .env による設定

GEM分析の設定は `.env` ファイルで管理します。`.env.example` をテンプレートとして使用してください。

### アップグレード手順

**1. テンプレートを更新**

```
dd-know-how/templates/dd_template.md
  → {プロジェクト}/{テンプレートフォルダ}/dd_template.md（上書き）
```

**2. workflowスキルを更新**

```
dd-know-how/.claude/skills/workflow/SKILL.md
  → {プロジェクト}/.claude/skills/workflow/SKILL.md（上書き）
```

**3. .env.example をコピー（オプション）**

```bash
cp dd-know-how/.env.example {プロジェクト}/
```

**4. .env を作成・設定（オプション）**

Gemini APIを使用する場合のみ:

```bash
cp .env.example .env
# GEMINI_API_KEY を設定
# .gitignore に .env を追加
```

### 既存DDへの影響

- **進行中のDD**: GEM分析結果セクションがないDDでも動作します。GEM分析実行時にセクションが追加されます
- **新規DD**: 更新後のテンプレートにGEM分析結果セクションが含まれます
- **GEMINI_API_KEY 未設定**: 別コンテキストDA分析にフォールバックするため、機能は利用可能です

---

## v2: DDスキル分割 + DA批判レビュー導入（2026-02-07）

### 概要

DDスキルの構造とレビュー手法を大幅に改善しました。
既にDD-Know-Howを導入済みのプロジェクトは、以下の手順でアップグレードできます。

### 主な変更点

#### 1. DDスキルの分割（コンテキスト効率改善）

**変更前:** `/dd` スキル1つに全機能（428行）
**変更後:** 2つのスキルに分離

| スキル | 行数 | 内容 |
|--------|------|------|
| `/dd` | ~120行 | DD操作のみ（参照・作成・一覧・アーカイブ） |
| `/workflow` | ~270行 | 9ステップフロー・Phase管理・DA批判レビュー・仕様書同期 |

**メリット:** DD参照だけの時にワークフロー全体がロードされなくなり、コンテキスト消費を削減。

#### 2. DA批判レビュー（Devil's Advocate）の導入

**変更前:** 「見落としチェック」— 「何を見落としているか？」を問う
**変更後:** 「DA批判レビュー」— **「どこが壊れるか？」を問う**

具体的な改善:
- **4段階の批判手順**: 壊れる前提で探す → 暗黙の前提を疑う → 将来の破壊を予測 → 記録
- **DA観点チェックリスト**: 矛盾・不整合、エッジケース、依存関係等の6項目
- **条件A（新規）**: 重要度「中」以上が1件でもあれば別角度で再チェック必須
- **記録テンプレート改善**: DA観点カラム、発動理由、切り替え視点の記録

#### 3. DDスキルの改善

- **添付ファイル配置ルール**: `DD-{番号}/` フォルダへの統一ルール
- **アーカイブ時チェックリスト**: 移動漏れ防止の必須チェック
- **DD分割の提案**: 100行超見込みで自動提案

---

### アップグレード手順

#### Level 2（/dd + /workflow）をお使いの場合

**1. スキルファイルを更新**

以下のファイルをdd-know-howリポジトリからコピー:

```
dd-know-how/.claude/skills/dd/SKILL.md
  → {プロジェクト}/.claude/skills/dd/SKILL.md（上書き）

dd-know-how/.claude/skills/workflow/SKILL.md
  → {プロジェクト}/.claude/skills/workflow/SKILL.md（新規）
```

**2. テンプレートを更新**

```
dd-know-how/templates/dd_template.md
  → {プロジェクト}/{テンプレートフォルダ}/dd_template.md（上書き）
```

**3. CLAUDE.mdにworkflowを追記**

```markdown
- `/workflow` - 9ステップ開発フロー・Phase管理・DA批判レビュー
```

#### Level 3（フル構成）をお使いの場合

Level 2の手順に加えて:

```
dd-know-how/doc/development-flow-full.md
  → {プロジェクト}/doc/development-flow-full.md（上書き）
```

---

### 既存DDへの影響

- **進行中のDD**: そのまま使えます。見落としチェック形式でも問題なく動作します
- **新規DD**: 更新後のテンプレートでDA批判レビュー形式になります
- **アーカイブ済みDD**: 変更不要です

### 用語の対応表

| 旧用語 | 新用語 |
|--------|--------|
| 見落としチェック | DA批判レビュー |
| 🔍 見落としチェック（最低1件発見） | 😈 DA批判レビュー（「このPhaseで何が壊れるか」を最低1件発見） |
| 見落としチェック記録 | DA批判レビュー記録 |
| 見落とし発見モード | DA批判レビュー（Devil's Advocate視点） |
