# DD設計書セットアップコマンド

外部プロジェクトにDD設計書の仕組みを導入するコマンドです。

## 使い方

```
/setup {対象プロジェクトのパス}
```

**例:**
- `/setup /path/to/my-project`
- `/setup ../my-other-project`
- `/setup` （カレントディレクトリ以外のプロジェクトを対話で指定）

## 前提条件

このコマンドは **dd-know-how リポジトリ内** で実行します。
（dd-know-how がセットアップのソースとなります）

## セットアップ手順

### 1. 対象プロジェクトの確認

引数でパスが指定された場合:
- そのパスが存在し、ディレクトリであることを確認
- 確認できない場合はエラーメッセージを表示

引数がない場合:
- ユーザーに対象プロジェクトのパスを質問

### 2. 導入レベルの選択

ユーザーに導入レベルを確認:

| レベル | 内容 | 推奨ケース |
|--------|------|------------|
| Level 1（最小） | テンプレート + 基本ルール | まず試したい |
| Level 2（標準） | + /dd コマンド + 開発フロー | 通常利用 |
| Level 3（フル） | + 仕様書連携 + レビューコマンド | 厳密な運用 |

### 3. DDフォルダの配置先を決定

対象プロジェクトのフォルダ構造を確認し、以下の優先順位で提案:

1. `docs/` フォルダが存在 → `docs/DD/` を提案
2. `doc/` フォルダが存在 → `doc/DD/` を提案
3. どちらもない → `docs/DD/`（推奨）または `doc/DD/` を選択させる

**ユーザーに確認**: 「DDフォルダを {提案パス} に作成します。よろしいですか？」

カスタムパスを指定したい場合はユーザー入力を受け付ける。

### 4. ファイルのコピー

確定した設定に基づき、以下のファイルをコピー:

#### Level 1（最小構成）
```
{対象プロジェクト}/
├── {DDフォルダ}/              # 例: docs/DD/
│   └── (空、またはサンプルDD)
├── {DDフォルダ}/../templates/
│   └── dd_template.md        # ← level-1-minimal/templates/dd_template.md
└── {DDフォルダ}/../archived/DD/
    └── (空フォルダ)
```

#### Level 2（標準構成）- Level 1 に加えて
```
{対象プロジェクト}/
├── .claude/
│   └── commands/
│       └── dd.md             # ← level-2-standard/commands/dd.md
└── CLAUDE.md                 # ← level-2-standard/CLAUDE.md.snippet の内容を追記
```

#### Level 3（フル構成）- Level 2 に加えて
```
{対象プロジェクト}/
├── .claude/
│   └── commands/
│       ├── dd.md             # ← level-3-full/commands/dd.md（上書き）
│       ├── review.md         # ← level-3-full/commands/review.md
│       └── review-spec.md    # ← level-3-full/commands/review-spec.md
└── {仕様書フォルダ}/          # 例: docs/spec/ （ユーザーに確認）
```

### 5. CLAUDE.md の更新

対象プロジェクトに CLAUDE.md が:
- **存在する場合**: スニペットの内容を末尾に追記（重複チェック）
- **存在しない場合**: 新規作成してスニペット内容を記載

### 6. パス設定の調整

コピーしたファイル内のパス参照を、実際の配置先に合わせて更新:

- `doc/DD/` → 実際のDDフォルダパス
- `doc/templates/` → 実際のテンプレートフォルダパス
- `doc/archived/DD/` → 実際のアーカイブフォルダパス

### 7. 完了報告

セットアップ完了後、以下を表示:

```
✓ DD設計書のセットアップが完了しました

【配置されたファイル】
- DDフォルダ: {DDフォルダパス}
- テンプレート: {テンプレートパス}
- アーカイブ: {アーカイブパス}
- コマンド: {コマンドパス}（Level 2以上）

【次のステップ】
1. `/dd new 最初のDD` で新規DDを作成
2. development-flow.md で開発フローを確認
```

## パス規約（推奨）

| 項目 | 推奨パス | 代替パス |
|------|----------|----------|
| DDフォルダ | `docs/DD/` | `doc/DD/` |
| テンプレート | `docs/templates/` | `doc/templates/` |
| アーカイブ | `docs/archived/DD/` | `doc/archived/DD/` |
| コマンド | `.claude/commands/` | （固定） |

## 注意事項

- 既存ファイルがある場合は上書き前に確認
- CLAUDE.md への追記は重複チェックを行う
- Git管理下の場合、変更をコミットするか確認
